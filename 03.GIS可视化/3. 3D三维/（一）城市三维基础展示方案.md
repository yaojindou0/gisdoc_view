- [（一）城市三维基础展示方案](https://www.cnblogs.com/naaoveGIS/p/10918411.html)

# 1. 数据源要求

​    基础数据中，需提供行政边界、水系、建筑物（必须带楼层属性）、道路、绿地等图层数据。

​    其中三维场景展示支持：

​    1）主打基于建筑物SHP的灰模展示，数据获取方便，成本低。

​    2）如有真三维数据（倾斜摄影、3dmax等），提供真三维数据+建筑物灰模整合，其中实现展示风格一致化：

​    ![img](https://img2018.cnblogs.com/blog/656746/201905/656746-20190524152509125-865841799.png)

​               （建筑物为真三维模型蒙皮效果，以求展示风格一致）

# 2. 宏观场景展示方案

## 2.1.底图展示方案

​    作为三维模型下的底图，需要即考虑到美观（与三维模型展示风格匹配），也不能失去作为地图本身需要有的功能（导航，即需要一定量的兴趣点和道路等数据展示）。目前暂时将地图瓦片分为0到24级别，各级别展示方案定义如下：

### a. 0到4级别瓦片源

​    为了使三维球有科技感，采用NASA的全球夜视影像作为三维球皮肤，背景采用银河星空（cubebox）6张纹理图拼接，效果如下：

   ![img](https://img2018.cnblogs.com/blog/656746/201905/656746-20190524152538942-962413178.png)

### b .5到9级别瓦片源

​    由于谷歌等地图（虽然是84墨卡托投影）在中国的偏移都比较大，而公网天地图在18级别以上后便不能访问，所以采用mapbox地图，mapbox地图有如下风格类型：

​                       ![img](https://img2018.cnblogs.com/blog/656746/201905/656746-20190524152613045-889789549.png)      

​    采用mapbox的streets地图，streets风格地图兴趣点和路网数据均符合要求，而且包含中文注记。但是，由于streets地图为浅色系，如下：

   ![img](https://img2018.cnblogs.com/blog/656746/201905/656746-20190524152625467-1158740299.png)   

​    为了符合深色科技感定位，并且满足请求的效率（没有使用mapboxstudio定制），三维团队研究了tonemapping方案，对浅色地图做匀色处理使其变为深色地图：

   ![img](https://img2018.cnblogs.com/blog/656746/201905/656746-20190524152635839-378322594.png)

### c.10到16级别瓦片源

​    在这几个层级，我们需要重点展示路网和行政信息，而且视野已经不是全球，所以只采用了使用已有采集的数据来展示，其中对于数据的配图要突出路网、行政边界等。所切瓦片以离线方式存储以加速瓦片获取。

   ![img](https://img2018.cnblogs.com/blog/656746/201905/656746-20190524152704777-1128175875.png)

### d.17到24级别瓦片源

​    不再叠加自身数据，原因为：

​    1）地图此时级别已经很大，可见均为非常小的范围，为了兴趣点注记更丰富，底图依然采用了mapbox的streets地图。

​    2）在mapbox地图上叠加自身的配图，会出现道路线压盖住mapbox地图的道路注记问题，而且该压盖并不是完全覆盖，导致出现明显的底图注记被遮挡问题。

   ![img](https://img2018.cnblogs.com/blog/656746/201905/656746-20190524152721319-725958256.png)

## 2.2 动态流向水域

​    水域分为河流和胡泊，其中河流展示希望能有流动的效果，胡泊则希望能够有光感的变化。针对这两种需求，研发分别开发了河流和胡泊特效，现场只需单独提供河流shp和胡泊shp即可：

   ![img](https://img2018.cnblogs.com/blog/656746/201905/656746-20190524152755834-318988672.png)

​                        （带流向河流与水面波动湖泊）

## 2.3光源特效

​    对建筑物和河流分别打上变化扩散光源，让城市基础展示更加有动效：

   ![img](https://img2018.cnblogs.com/blog/656746/201905/656746-20190524152846604-630679322.png)

# 3. 待完善基础场景点

​    1）桥梁展示。

​    2）建筑物轮廓增强。

​    3）悬空注记。