- [地图采集车的那些事  |  惯性导航](https://www.cnblogs.com/amap_tech/p/15156390.html)

# 一、背景

高精地图、高精采集车，是做地图和出行领域同学经常挂在嘴上的一些常用词儿。但是，圈外的同学可能会问，到底什么是高精？

<font color='red'>高精是指**高精度定位**，高精地图是指包含丰富地理信息数据、具有高精度坐标的地图。当然，高精采集车就是采集制作高精地图数据的特种作业车。</font>

有些好奇的小伙伴会打破砂锅问到底，高精是怎么实现的呢？怎样才能叫高精度？

事实上，目前高精度的标准并不是很确定，但基本认为**厘米级以上**的精度才能算是高精度。高精的实现，主要是靠各类传感器，其中最重要的就是高精度定位定向系统，包括卫星定位及惯性导航两部分。

本文主要从硬件角度给大家介绍一些这方面的情况，以及在实际工作中对它的运用。

# 二、术语解释

**定位定向系统**：POS系统（Position and Orientation System,  POS），是指惯性导航+GNSS卫星导航组合的高精度位置与姿态测量系统，利用装在载体上的卫星接收机精确测定空间位置，利用惯性测量装置测定瞬间传感器姿态，通过精确时钟将两者结合起来，最后经过运算，获取载体的速度和姿态、位置等信息。

**惯性导航系统**：简称惯导，是以陀螺和加速度计为敏感器件的导航参数解算系统，根据陀螺/加速度计的输出，建立导航坐标系，解算出载体在导航坐标系中的速度和位置。

**IMU**：惯性测量单元（Inertial Measurement Unit），是测量物体三轴姿态角(或角速率)以及加速度的装置。IMU是惯性导航系统的一部分。

**GNSS：**全球导航卫星系统（Global Navigation Satellite  System），泛指所有的卫星导航系统，包括全球的、区域的和增强的，如美国的GPS、俄罗斯的Glonass、欧洲的Galileo、中国的北斗卫星导航系统，以及相关的增强系统，如美国的WAAS（广域增强系统）、欧洲的EGNOS（欧洲静地导航重叠系统）和日本的MSAS（多功能运输卫星增强系统）等，还涵盖在建和以后要建设的其他卫星导航系统。

备注：我们内部习惯把定位部分简称为惯导，实际不仅仅包含惯导设备，是指包含整套软硬件的定位定向系统。

# 三、高精度定位定向系统包括什么

采集车上的高精度定位定向系统，一般主要由下面几部分组成：

![img](https://mp.toutiao.com/mp/agw/article_material/open_image/get?code=MzNlMzQzMzM0N2JjMjU3M2Q4NDA0OTUxZGExOGExNjAsMTYyOTI1ODIyNzUzMA==)

定位定向系统的构成

![img](https://mp.toutiao.com/mp/agw/article_material/open_image/get?code=MzQ3N2M5ZWYxNWVjNDQyYTRhYmFlYTk1YmM3M2Y0MDIsMTYyOTI1ODIyNzUzMA==)

算法过程

整个系统由硬件和配套的软件及算法组成，由于组合解算的算法在业界有非常多的研究，各种方法和思路也是百花齐放，在高德内部有相关的同学做这方面的开发工作。因此，本文仅侧重于硬件角度的介绍。

低精度、高精度定位系统的组成内容差不多，区别只是传感器（IMU、GNSS）的精度等级不同。

# 四、各传感器的作用和角色

## 1.GNSS

类似以前常说的GPS，但是随着科技进步，咱们国家的北斗系统BD在精度和可靠性上也能匹敌GPS了，在实际运用中发挥着重要作用。

从几十元的模组，到上万元的高精GNSS板卡，定位原理基本一致，都是测量出已知位置的卫星到用户接收机之间的距离，然后综合多颗卫星的数据就可知道接收机的具体位置。卫星位置可以根据星载时钟所记录的时间在卫星星历中查出。

但是在信噪比、频段、星座数量、通道数、信号捕获跟踪等能力上，高精度GNSS板卡显著优于普通的GPS，例如手机一般仅支持GPS L1频段的C/A码，但是专业级的板卡基本都支持L1/L2/L5多频段、多通道。

除了在实时定位精度上显著优于普通模组，专业的GNSS板卡还可以进行后处理，精度达毫米级，这就是专业接收机板卡的价值所在。

业内主要的卫星接收机厂商包括国外的天宝Trimble、诺瓦泰Novatel、徕卡LeiCa、拓普康等，以及国内的北斗星通、华测、中海达、司南等。

GNSS在系统中的主要作用是获取当前位置的绝对坐标，优点是不存在位置误差累积，缺点是更新频率低，一般最高不超过10~50HZ。

## 2.IMU

事实上，IMU才是俗称惯导的高精度定位定向系统的核心，价格上也反应了这一点：如某个近百万元的设备，卫星接收机部分仅占数万元，其余大部分都是IMU费用。

从某种程度上讲，选定位定姿系统，其实重点是选IMU，因为GNSS部分选型相对简单直观。

本文后面也主要以IMU为侧重阐述对象。

IMU通常由三个单轴的加速度计和三个单轴的陀螺仪组成，加速度计检测载体在坐标系统中独立三轴的加速度信号，而陀螺仪检测载体相对于坐标系的角速度信号，对这些信号进行处理之后，便可解算出载体的姿态。

值得注意的是，IMU及惯性推算算法提供的是一个相对的原始定位信息，它的作用是测量相对于起点所运动的路线，所以它并不能提供你所在的具体位置的信息。因此，它常常和GNSS一起使用，当在某些GNSS信号微弱甚至缺失的地方时，IMU就可以发挥它的作用，可以让载体持续获得绝对位置姿态信息。

IMU的更新频率较高，一般可达几百至1KHz。使用三个加速度值，通过两次积分可获得位移，以此实现位置定位，有角速度值积分可以获取姿态信息，结合在一起可获得物体的实际状态。

别看IMU这个技术说起来比较陌生，其实我们每天使用的手机，以及汽车、飞机，乃至宇宙飞船都会使用到IMU，区别在于材料、成本和精度。

根据不同的使用场景，对IMU的精度有不同的要求，精度高，也意味着成本高。咱们高精车，当然使用最高等级的。

![img](https://mp.toutiao.com/mp/agw/article_material/open_image/get?code=Zjc1Yzg5ZTc4ZGI2OTllMzgyYjcyZDYxNDNmMzdhY2MsMTYyOTI1ODIyNzUzMA==)

IMU的价格和精度对比

## 3.里程计

标准的里程计一般外挂安装在车轮上，内置一个旋转编码器，通过车轮带动共同旋转。作用是测量车辆移动的线性距离，并在卫星失锁时帮助抑制漂移误差。里程计的形式有多种多样，除外挂旋转编码器外，磁栅式、霍尔式等等都有应用。

## 4.增强、辅助手段

主要是一些陆基和星基增强技术，包括RTK、RTD、PPK、PPP、DGPS、各种SBAS等，我们平时作业时很少会用到星基增强系统，主要用到的是陆基增强系统。高精采集一般采用事后差分解算处理的方法。

# 五、惯性导航是怎么炼成的

前面已经说过，定位定向系统包含惯性导航，惯性导航的主要硬件是IMU，而IMU是由陀螺和加速度计两大部分组成的。

## 1.陀螺仪

先看看陀螺是啥样子？是的，就是下面这个东东。

![img](https://mp.toutiao.com/mp/agw/article_material/open_image/get?code=NWMwNjMxZDZiZDI2YTlhMjU1OWEyNTZhZjcxYjljMDAsMTYyOTI1ODIyNzUzMA==)

这个陀螺和我们平时理解的惯性导航设备内的角速度传感器有什么关系？

从制作工艺和材料、原理上讲，没太大关系，是两种不同的东西。但是这些东西，都可当作旋转角速度传感器用，而这种类似机械陀螺形态的产品最先使用，先入为主了，所以后来把这种角速度传感器，都叫做陀螺仪。

事实上陀螺仪的种类很多，根据物理原理大体上可分为机械陀螺、激光陀螺和光纤陀螺、微机械（MEMS）陀螺等等。

**机械陀螺仪**：在早期的飞机曾大量使用。它体积大、结构复杂、精度差。后期有一些改进的类型，如：滚珠轴承自由陀螺仪、液浮陀螺仪等。

**激光陀螺**：利用萨格纳克理论中的光程差来测量旋转角速度。其要点是：当光束在一个环形的通道中前进时，如果环形通道本身具有一个转动速度，那么光线沿着通道转动的方向前进所需要的时间、要比沿着这个通道转动相反的方向前进所需要的时间要多。

![img](https://mp.toutiao.com/mp/agw/article_material/open_image/get?code=ZTQzOWUxZjRhMTM5MWM5ODQ2NzEyMTE0YWJmODY3YjQsMTYyOTI1ODIyNzUzMA==)

萨格纳克实验

这个萨格纳克理论很有意思，感兴趣的同学可以自行加深了解。

激光陀螺实际上是一种环形激光器。在闭合光路中，由同一光源发出的沿顺时针方向和反时针方向传输的两束光和光干涉，利用检测相位差或干涉条纹的变化，就可以测出闭合光路旋转角速度。当环形激光器处于静止状态时，两束激光绕行一周的光程相等，因而频率相同，两个频率之差(频差)为零，干涉条纹为零。

当环形激光器绕垂直于闭合光路平面的轴转动时，与转动方向一致的那束光的光程延长，波长增大，频率降低；另一束光则相反，因而出现频差，形成干涉条纹。

激光陀螺没有内部运动器件，数据漂移率低，可靠性高，测量精度高。由于光程差的关系，激光陀螺会有一定的速度门限，低于这个门限，可能会检测不到角速度变化。另外，因为要使用环形激光器的缘故，整个器件体积大、成本高。

**光纤陀螺**：严格讲也属于激光陀螺，原理与激光陀螺仪一样，只不过用光纤代替了环型激光器。光纤的成本低，但是易受温度变化造成的热胀冷缩不均以及缠绕时张力变化影响，故精度稍低。激光陀螺的光在谐振腔中传播，受外界影响小，因此精度较高，但谐振腔成本昂贵。因为在成本、体积上更有优势，所以光纤陀螺在实践中获得了大量运用。

**微机械陀螺**：即MEMS陀螺，是用半导体技术刻蚀出来的微型机械结构和CMOS电路技术相结合的产品。它的特色是体积小、成本低，便于大批量生产，广泛应用于手机、便携式设备和其他一些对性能要求不高的领域。此外，随着技术进步，某些高端MEMS陀螺，精度已经可以媲美光纤陀螺了。

MEMS陀螺的原理是利用科里奥利力——旋转物体在有径向运动时所受到的切向力来传感角速度。振动物体被柔软的弹性结构悬挂在基底之上。整体动力学系统是二维弹性阻尼系统，在这个系统中振动和转动诱导的科里奥利力把正比于角速度的能量转换到传感模式，并计算输出。

## 2.加速度计

加速度计的作用是测量载体的加速度力，以确定载体在空间中的位置并监测起的运动，加速度是矢量、是速度的变化率 。

加速度计的类型较多，从**材料**上，有石英挠性、液浮加速度计和MEMS几种。

按**传感元件**分类，大体上又可以分为几种类型：压电式加速计、压阻式加速计和电容式加速计，此外还有热流式、谐振式。

**压电式加速度计**利用压电效应（压电材料在受到物理应力时产生电）来感知加速度的变化。压电加速度计最常用于振动和冲击测量。压阻式加速度计比压电式加速度计灵敏度低得多，更适合于车辆碰撞试验。压阻式加速度计的电阻与施加在其上的压力成比例。

最常用的加速度计是**电容式加速度计**，它是利用电容的变化来确定物体的加速度。当传感器经历加速度时，其电容板之间的距离随着传感器膜片的移动而变化，从而探测出加速度值。

## 3.为什么要做组合导航

实际应用中，单一的导航定位模式是很难满足导航性能要求的，提高导航系统整体性能的有效途径是采用组合导航技术，即用两种或两种以上的非相似导航系统对同一导航信息作测量并解算，以形成量测值，从这些量测值中计算出各导航系统的误差并校正。

例如陀螺仪测角速度，加速度测线性加速度。前者是惯性原理，后者是利用的力平衡原理。加速度计在较长时间的测量值是正确的，而在较短时间内由于信号噪声的存在，有误差。陀螺仪在较短时间内则比较准确，而较长时间则会有与漂移而存有误差。因此，需要两者相互调整来确保信号的正确。

又例如在整个系统中，IMU提供载体姿态，并可推算相对位置，其优点是更新频率高，输出连续，数据平稳，短期稳定性好，但缺点是存在误差累积，精度随时间而发散，长期稳定性差，因为位置信息和姿态信息是积分求得的。而GNSS卫星导航的优点是不存在位置误差累积，长期稳定性好，缺点是更新频率低，且信号存在不连续的可能。

所以GNSS和IMU两者可以实现互补，通过GNSS实现长时间绝对定位，在GNSS位置更新的间隙可以采取IMU进行推算定位，并利用GNSS修正误差。

由于IMU和GNSS在性能上正好形成互补，因此采用这两种设备组合起来作为定位定向系统设计是业内公认的最佳方案。

# 六、IMU的主要参数

对于性能参数要求，需要从加速度计和陀螺仪两个方面入手，相关的指标较多，一般主要是关注以下这些：

![img](https://mp.toutiao.com/mp/agw/article_material/open_image/get?code=YjViMTljNWRiMWVlYjIyNzEzNmRmZWNjOWJlODk3NWMsMTYyOTI1ODIyNzUzMA==)

# 七、影响精度的误差因素

惯性导航系统中，硬件部分对精度造成影响的主要是IMU性能好坏，其误差源如下图所示：

![img](https://mp.toutiao.com/mp/agw/article_material/open_image/get?code=OGFlMzg5ZjMyMjU0OTEzYjY2ZjIyMTgyNTFlYTA5ZjAsMTYyOTI1ODIyNzUzMA==)

惯性导航误差源

## 1.陀螺仪影响因素

作为惯性导航设备上的核心传感器，陀螺仪的重要程度不言而喻。姿态推算数据很大程度上需要依赖角速度的数据质量，因此陀螺仪的精确性将直接影响解算的优劣程度，换句话说，最后IMU能否正确感知载体的姿态就是依靠陀螺仪的精度性能。

## 2.加速度计影响因素

在IMU中，加速度计对其的影响主要体现在加速度计的稳定性和精度两个方面。其中加速度计的高精度是为保障后续数据处理的精确性，加速度计的稳定性则是直接影响IMU能否发挥出正常性能的关键因素之一。

## 3.温度影响因素*

传感器在温度发生变化时，其精度会产生较大的差异，一般情况下，惯性器件的工作环境不可能是恒温环境，尤其是陀螺的精度受到严重影响，因此温度的影响不能忽略。

## 4.误差处理

定位定向系统的误差源很多，在惯性器件的硬件方面误差一般分成两类：系统性误差和随机误差。系统性误差本质就是能找到规律的误差，所以可以实时补偿掉，主要包括常值偏移、比例因子、安装误差等。

但是随机误差一般指噪声，无法找到合适的关系函数去描述噪声，所以很难处理。一般采用allan方差、时间序列分析法等手段对零点偏移的数据进行误差建模分析，例如可以用卡尔曼滤波算法减小随机噪声的影响。

# 八、怎么选定位系统

设计高精采集系统的方案时，一个重要的事情就是惯性导航设备的选取，因为它不仅关系到硬件成本，还关乎到最终产品的精度性能。具体选型时，主要任务之一是考察其中的IMU，无外乎要关注如下几个方面，然后根据产品需求进行取舍。

- 传感器的各项指标参数是否满足需求。
- 传感器的价格是否合理，供应链是否完善。
- 配套软硬件的设计难度是否可以接受。
- 厂商的技术支持能力、配套服务是否良好。

这其中最主要的是第一项，也是先决条件，只有当技术性能满足要求，才会去进行下一步的成本、商务方面的考量。

## 1.指标分析

我们还是从最重要的技术方面分析，介绍几个在陀螺选型过程中比较关键的指标：

**量程**

量程是在选用传感器的时候要首先确定的，所选传感器用于什么领域，一般对车载来说，陀螺选择在300度/秒以内、加速度计在4G以内就可以了，其他的根据自己的使用场景做选择，比如说机载的量程需要大一些，轨道交通上的可以更小。高精度的情况下，量程小一点对应的精度会高一些。

**零偏及零偏稳定性**

从原理上来讲，陀螺仪上电或开始工作时会出现漂移，又分为**常值漂移**和**随机漂移**两种，其中常值漂移就叫零偏，也可称为零漂，单位为°/h、°/s。通过获取陀螺仪的零偏，我们就可以在后续使用中对其进行补偿，但补偿的是多次测量的均值，在补偿后常值漂移在陀螺的输出中还会有一部分残余，因此，就出现了陀螺测试中的零偏重复性指标，它表征陀螺每次零偏的接近重复程度，零偏重复性好的陀螺经过标定补偿后，残余的常值漂移比较小，可以达到更高的精度。

零偏稳定性则是计算一次通电过程中陀螺输出数据的方差得到，计算方差时上面提到的常值漂移被扣除，因此零偏稳定性反映的是陀螺的随机漂移指标，又称随机噪声。

零偏及零偏稳定性，很大程度上反应了陀螺和加速度计的性能，长久以来它被视为惯性器件规格的关键指标。选型时应根据成本和精度要求，选择合适的型号。

**角度随机游走**

当陀螺仪处于零输入状态时，输出信号为白噪声和慢变随机函数的叠加。漫变随机函数可用来确定零偏和零偏稳定性指标。

陀螺随机游走所产生的姿态和速度长值误差为零，但速度和姿态存在一定的震荡误差，震荡幅值与陀螺漂移随机游走大小相关。随机游走会引起震荡幅值较大的位置误差，但位置误差均值并不随时间线性增长，而是呈现随机游走过程。

随机游走反映了陀螺仪的研制水平，也反映了陀螺仪最小可检测的角速率。

**物理条件**

（1）外形尺寸

评估外形尺寸主要需根据实际车辆安装情况，选择合适的尺寸，且需要IMU具有良好的环境适应性。对于IMU本体来说，其质心位置应尽量与IMU物理中心贴近。

（2）电气及接口要求

常规的车辆供电为9-16V，选型应考虑其工作电压范围是否符合，否则需要增加电源转换模块。此外，需考察是否有短路、过压等自我保护功能。

接口方面，需明确接口类型和线缆形式，如USB/以太网/串口等，数据速率与通讯形式是否匹配等，避免使用中出现数据中断丢失等情况。

（3）环境要求

惯性传感器对温度变化都很敏感，因此需注意其温度漂移相关指标，对某些温漂大的设备，应注意安装环境，并尽量提供稳定的工作环境温度，例如加风扇/空调散热，或是加温装置等。

此外，需注意IMU的防护等级，选择车外或车内安装，并做好相应的防水防尘措施。

（4）相关标准及规范要求

包括并不限于：

- 车载卫星导航设备通用规范（GB/T 19392-2013）。
- 车载电子设备可靠性测试标准（ISO 16750）。
- 道路车辆功能安全国际标准（ISO 26262 2018）。
- 道路车辆电气及电子设备的环境条件和试验（GB/T 28046）。

## 2.注重测试

对于惯性导航设备这类注重性能、功能单一的产品，需着重考察其实际表现，不能完全相信技术手册中的指标，例如下面二款常用的大厂出品的主流设备，可以看到参数差别不大，精度也都很高，实际表现如何呢？

Trimble POS LV 510标称精度指标：

![img](https://mp.toutiao.com/mp/agw/article_material/open_image/get?code=NGU1YzU4ZDFhYWU4Njk2NjJiNmM4Y2E4Njc4OGEwNDcsMTYyOTI1ODIyNzUzMA==)

Novatel SPAN-CPT标称精度指标：

![img](https://mp.toutiao.com/mp/agw/article_material/open_image/get?code=ZjE4Y2YzNGU2OWE4NWE3OTA4YzU2NzVjZWQyMzg3YmQsMTYyOTI1ODIyNzUzMA==)

其实一分钱一分货，价格也自然代表了性能，POS LV510精度实际上大幅优于CPT，所以二者的应用场景也不同，510可以做高精采集，CPT只用来做更新或者ADAS采集。

另外不要被指标迷惑了，标称的0.02米的精度，那是理想作业情况的结果。

除了看指标，还能怎么选呢？

俗话说是骡子是马，拉出来溜溜，这话放在选型上也适用，我们的办法就是：实测。毕竟实践是检验真理的唯一标准。

目前，**定位定向系统级测试方法主要有：实际运动试验，软件仿真测试，软件-硬件结合的半物理实物仿真测试**。这里面，实际运动试验显然是最直观真实的，我们通常采用跑车试验来考察精度情况。

试验阶段一般分设备准备、路线规划、数据采集、数据分析几个步骤。

**设备准备**：做定位定向系统的精度评估，需要一个参考标准，这样当行驶同样的路线时，被测设备的轨迹及姿态误差情况才能够得到准确的量化，实践中往往是用一个等级很高的设备作为基准，即真值，与被测设备共同安装在同一载体平台上，采集同一路线的轨迹和载体姿态。

安装时，含有IMU的部分需要牢固的安装在平台上，本体测量方向保持和车辆的前进、水平方向正交/平行，不可自由晃动；天线的安装位置应保证无遮挡，收星状态良好，附近无干扰源。必要的情况下需接入里程计。电源及数据线缆按照规定连接。

**线路规划**：不同的场景对定位系统的需求会不一样，但对我们来说，主要是道路数据采集，并且是全路况采集，这就不仅仅是高速路、乡村道路这种卫星信号良好、对惯性导航要求不高的路段，也包括城市普通路、环线、高架桥上下、停车场、普通国道等卫星信号有遮蔽甚至中断的场景，因此测试路段选择，需尽可能全面，覆盖这些场景。

除正常测试的场景要求外，因为惯导往往有初始化的需求，因此在测试线路的起点和终点，都应选择开阔地、卫星信号好的地方。

**数据采集**：数据采集相对简单，遵守相关作业规范，按照规定线路采集被测设备和真值设备的数据即可。为保证可靠性和一致性并便于对比，往往是同一线路做多次往复采集。参考站方面，可以自行架设，也可以使用千寻等服务商的数据。

**数据分析**：跑车结束后，采集的惯导、GNSS原始数据，及参考站数据进入后处理软件进行各项预处理、格式转换、滤波、差分解算、融合、平滑处理等一系列过程后，输出轨迹和姿态数据。

![img](https://mp.toutiao.com/mp/agw/article_material/open_image/get?code=NDQ3ZTRiYmVlY2RlZjlhOTJlZjc5MDk1N2Q1MTgwNzYsMTYyOTI1ODIyNzUzMA==)

数据分析

可以选取多条轨迹，在平面位置、高程、航向角、翻滚俯仰角等指标上与真值设备的输出做对比，得出各种场景下的误差范围，据此分析被测设备的性能，为选型做依据。

除了使用更高等级的设备作为真值来检验被测设备的精度外，也可以使用其他方法，例如，标定好的近景摄影测量采集系统+控制场的方法，来估算精度情况。

# 九、小结

本文从硬件角度大致介绍了定位定向系统中惯性导航设备及其传感器的基本情况。实际上，这些传感器在应用中，仍有很多环节需要处理，才能够达到最终用户使用的状态。像出厂前的环境试验、老化、筛选、转台标定等等，也是十分重要的，而组合推算算法更是关键，这些组合拳一整套都打下来，才有了高精。