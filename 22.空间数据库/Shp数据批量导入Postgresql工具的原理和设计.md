- [Shp数据批量导入Postgresql工具的原理和设计](https://www.cnblogs.com/naaoveGIS/p/4872189.html)

# 1.背景

在制作整体的开源工具箱产品中，数据入库是一个重要的环节。虽然PostGIS提供了数据入库界面化操作，但是毕竟此工具无法集成至我方工具箱中，并且该工具界面、操作都不是很理想，也无法定制化完成一些具体需求。所以，自制一个shp入库工具还是比较有必要的。

# 2.思路

## 2.1 shp导入思路

Shp导入至数据库中，无论是Postgresql、mysql、oracle等，均是先将Shp转换成符合对应数据库的sql，然后再导入进去对应数据库。

针对Postgresql，在PG的安装路径下有pgsql2shp.exe工具可以支持将Shp数据转换成符合要求的sql。

![img](https://images2015.cnblogs.com/blog/656746/201510/656746-20151012170046585-464288058.png)            

## 2.2批量导入思路

我们可以利用编写Bat文件，将转换生成的各sql依次导入。

 ![img](https://images2015.cnblogs.com/blog/656746/201510/656746-20151012170056038-378705672.png)

## 2.3注意事项

a.Postgresql中可能会出现缺少某些空间信息表以及空间函数的问题，从而导致数据无法导入。针对这种问题，我们可以在导入前进行相关表和函数的检查，然后进行整体批量导入。

b.Shp以及shp所在文件路径需要为英文。

 ![img](https://images2015.cnblogs.com/blog/656746/201510/656746-20151012170105460-648713300.png)

# 3.流程图设计

 ![img](https://images2015.cnblogs.com/blog/656746/201510/656746-20151012170122866-663399012.png)

 

# 4.实现

 ![img](https://images2015.cnblogs.com/blog/656746/201510/656746-20151012170132272-80003711.png)